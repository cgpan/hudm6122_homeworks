---
title: "HUDM6122 Homework_01"
author: Chenguang Pan
date: Jan 28, 2023
output:
  pdf_document:
    toc: false
    toc_depth: 4
    number_sections: true
    keep_tex: true
    highlight: tango
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(
  cache = TRUE,
  prompt = TRUE,
  comment = '',
  collapse = TRUE,
  warning = FALSE,
  message = FALSE)
```

## Exercise 1.1  
First, I made a xlsx. version of `Table 1.1` to let R read it directly using the package `readxl``. This table is in 10x7 size. The first column is just the index of each observation, so I drop it here. Finally this dataset is in 9x7 size.   

One should notice that the `sex`, `depression`, and `health` are categorical variables. The Pearson Correlation Coefficient is used for continuous rather than categorical variables. Therefore, when calculate the correlation matrix we should drop the categorical ones.    

Note, there are some parameters need to be set. Since the original dataset contains missing value, I construct the correlation matrix based on all complete observations.
```{r}
library(readxl)
table_11 <- read_excel("table_1.1.xlsx")
my_data <- table_11[,c(2:7)]
# drop the discrete vars and use only the complete observations
my_data_cor <- round(cor(my_data[,c(2,3,6)], use = "complete"),2)
# the output is rounded in two decimals.
my_data_cor
```     

## Exercise 1.2   
Fill the `NA` with the column's mean, and recalculate the correlation matrix.  
```{r}
# to impute the NA with mean using a for-loop
for (cols in c(2,3,6)) {
  my_data[,cols][is.na(my_data[,cols])] <- mean(my_data[,cols], na.rm=T)
}
# create the correlation matrix
my_data_cor_2 <- round(cor(my_data[,c(2,3,6)]),2)
my_data_cor_2 
```   

## Exercise 1.3   
The authors may not clearly say where can readers find the original dataset. After seeing the code underlying in this book's R package `MVA`, and run this argument `demo("Ch-MVA")`, one can find the `table 1.3`'s dataset information at the paragraph named `code chunk number 5`. It is in another package called `HSAUR2`.   
```{r}
# load the Table 1.3's original dataset 
library(HSAUR2)
dim(pottery)
names(pottery) # the dataset is the same
# par(mfrow = c(4,3))
for (i in c(1:length(ncol(pottery)))){
  col_name <- colnames(pottery)[i]
  qqnorm(pottery[,i],
         xlab = "Normal Scores",
         main = col_name)
  qqline(pottery[, i])
  }
```


